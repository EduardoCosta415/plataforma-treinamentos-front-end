<h2 class="page-title">Meu Curso</h2>

<div *ngIf="loading" class="card" style="padding:16px;">
  Carregando curso...
</div>

<div *ngIf="error" class="alert-error">{{ error }}</div>

<div *ngIf="!loading && course">
  <div
    *ngFor="let module of course.modules; let mIndex = index"
    class="card"
    style="padding:16px; margin-bottom:14px;"
  >
    <div style="font-weight:900; margin-bottom:10px;">
      {{ module.order }}. {{ module.title }}
    </div>

    <div
      *ngFor="let lesson of module.lessons; let lIndex = index"
      style="
        padding:10px;
        margin-bottom:8px;
        border-radius:6px;
        display:flex;
        justify-content:space-between;
        align-items:center;
      "
      [ngStyle]="{
        background: isCompleted(lesson.id)
          ? '#e6f7ee'
          : isLessonUnlocked(mIndex, lIndex)
          ? '#eef5ff'
          : '#f2f2f2'
      }"
    >
      <div>
        <strong>{{ lesson.order }}. {{ lesson.title }}</strong>

        <div *ngIf="lesson.videoUrl" style="font-size:12px; color:var(--muted);">
          V√≠deo dispon√≠vel
        </div>
      </div>

      <!-- STATUS -->
      <div>
        <span *ngIf="isCompleted(lesson.id)">‚úÖ</span>
        <span *ngIf="!isCompleted(lesson.id) && isLessonUnlocked(mIndex, lIndex)">‚ñ∂Ô∏è</span>
        <span *ngIf="!isLessonUnlocked(mIndex, lIndex)">üîí</span>
      </div>

      <!-- A√á√ÉO -->
      <button
        *ngIf="!isCompleted(lesson.id) && isLessonUnlocked(mIndex, lIndex)"
        class="btn btn-primary"
        (click)="completeLesson(lesson.id)"
      >
        Concluir
      </button>
    </div>
  </div>
</div>
